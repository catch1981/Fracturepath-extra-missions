<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Coven Zero — The North Witch</title>
<style>
  :root{
    --bg:#0b0b0e; --ink:#e9e9f4; --muted:#a0a5b5;
    --glow:#ff2e9b; --ember:#ff6a00; --ward:#7c4dff;
    --panel:#12121a; --line:#1e1e2a; --ok:#6ee7b7; --bad:#ff395e;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;}
  body{font-family:ui-sans-serif,system-ui,Segoe UI,Inter,Roboto,Arial;background:
    radial-gradient(1200px 820px at 70% 10%, #1a0f1f 0%, #0b0b0e 60%); color:var(--ink)}

  .wrap{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
  header,footer{padding:14px 18px;border-bottom:1px solid var(--line)}
  footer{border-top:1px solid var(--line);border-bottom:none;color:var(--muted)}
  .grid{display:grid;grid-template-columns:1fr min(760px, 92vw) 1fr}
  .center{grid-column:2}

  .sigil{letter-spacing:.12em;font-weight:700;text-transform:uppercase;opacity:.9}
  .sigil .glow{color:var(--glow);text-shadow:0 0 18px #ff2e9b66}
  .tag{font-size:.85rem;color:var(--muted)}

  .stage{
    position:relative;background:linear-gradient(180deg,#13131b 0%, #0f0f16 100%);
    border:1px solid #232337;border-radius:14px;padding:18px;
    box-shadow:0 10px 40px #0008, inset 0 0 0 1px #ffffff08;overflow:hidden;
  }
  .bubble{
    margin:16px 0;padding:16px;border:1px solid #24243a;border-radius:12px;
    background:rgba(20,20,29,.55);backdrop-filter:blur(8px);
    animation:fadeIn .45s ease both;
  }
  .bubble h2{margin:0 0 6px;font-size:1.15rem}
  .bubble p{margin:.35rem 0 .5rem;color:#cfd0db}
  .opts{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
  .btn{
    border:1px solid #2a2a44;background:#141423;color:var(--ink);
    padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;
    transition:all .15s ease;user-select:none
  }
  .btn:hover{border-color:#3a3a66;transform:translateY(-1px)}
  .btn.primary{border-color:#4b2a5f;background:linear-gradient(180deg,#23122c,#1a1023)}
  .btn.bad{border-color:#5e1d33;background:#1a0f16}
  .btn.ok{border-color:#1c3b2e;background:#0e1a16}

  .prog{height:6px;border-radius:999px;background:#181828;border:1px solid #26263a;overflow:hidden}
  .prog .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--ward),var(--glow),var(--ember));transition:width .4s ease}

  .rune{position:absolute;right:12px;top:12px;font-weight:800;letter-spacing:.14em;color:#ffffffaa;text-shadow:0 0 10px #ff2e9b55;opacity:.7;pointer-events:none}
  .note{font-size:.9rem;color:var(--muted)}
  .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:.9rem;background:#0f0f18;border:1px solid #26263a;padding:2px 6px;border-radius:6px}
  .divider{height:1px;background:linear-gradient(90deg,#0000,#2b2b44,#0000);margin:14px 0}

  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

  /* Interlude (image between choices) */
  .interlude{
    display:none; position:relative; margin:16px 0; padding:0; border-radius:12px;
    overflow:hidden; border:1px solid #282844; background:#0c0c14;
    animation:fadeIn .35s ease both;
  }
  .interlude img{display:block;width:100%;height:auto;object-fit:cover}
  .interlude .bar{
    display:flex;justify-content:space-between;align-items:center;gap:10px;
    padding:10px 12px;border-top:1px solid #282844;background:#11111a;
  }
  .interlude .title{font-weight:700;letter-spacing:.06em}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="grid"><div class="center">
      <div class="sigil">COVEN ZERO • <span class="glow">NORTH WITCH</span> • FIREWALL NODE</div>
      <div class="tag">“The glitch is the plan. The fracture is the doorway. The Witch is the Seal.”</div>
    </div></div>
  </header>

  <main class="grid">
    <section class="center stage" id="stage">
      <div class="rune">⛧⛓</div>

      <!-- Bubbles -->
      <div class="bubble" id="welcome">
        <h2>Entry Rite</h2>
        <p>The auroras tear like broken code. The <b>North Witch</b> regards you without blinking.</p>
        <div class="opts">
          <button class="btn primary" data-next="mem">Enter Trial</button>
          <button class="btn bad" data-next="flee">Flee</button>
        </div>
      </div>

      <div class="divider"></div>
      <div class="prog" aria-label="progress"><div class="bar" id="bar"></div></div>

      <div class="bubble" id="mem" style="display:none">
        <h2>Shade of Memory</h2>
        <p>Whispers braid from the ice — every fracture you tried to forget.</p>
        <div class="opts">
          <button class="btn primary" data-score="1" data-interlude="0" data-next="flesh">Confront the voices</button>
          <button class="btn" data-score="0" data-interlude="0" data-next="flesh">Deny them</button>
        </div>
      </div>

      <div class="bubble" id="flesh" style="display:none">
        <h2>Shade of Flesh</h2>
        <p>The wind compresses your bones. The Witch asks: <i>what will you surrender?</i></p>
        <div class="opts">
          <button class="btn primary" data-score="1" data-interlude="1" data-next="fire">Blood</button>
          <button class="btn" data-score="1" data-interlude="1" data-next="fire">Breath</button>
          <button class="btn" data-score="0" data-interlude="1" data-next="fire">Silence</button>
        </div>
      </div>

      <div class="bubble" id="fire" style="display:none">
        <h2>Shade of Fire</h2>
        <p>Flame peels away the mask. Only your core remains.</p>
        <div class="opts">
          <button class="btn ok"  data-score="1" data-interlude="2" data-next="outcome">Accept your truth</button>
          <button class="btn bad" data-score="0" data-interlude="2" data-next="outcome">Reject the flame</button>
        </div>
      </div>

      <!-- Interlude component (auto-inserted image between steps) -->
      <figure class="interlude" id="interlude">
        <img id="interlude-img" alt="North Witch Vision" />
        <figcaption class="bar">
          <div class="title">North Witch — Vision</div>
          <button id="continueBtn" class="btn primary">Continue</button>
        </figcaption>
      </figure>

      <div class="bubble" id="outcome" style="display:none">
        <h2 id="outcome-title">—</h2>
        <p id="outcome-text" class="note"></p>
        <div class="opts" id="again" style="display:none">
          <button class="btn" onclick="location.reload()">Walk the Rite Again</button>
        </div>
      </div>

      <div class="bubble" id="flee" style="display:none">
        <h2>Retreat</h2>
        <p class="note">You turn from the auroras. The path collapses into frost. The Witch forgets your name.</p>
        <div class="opts">
          <button class="btn" onclick="location.reload()">Return to the Gate</button>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="grid"><div class="center">
      <span class="note">Tip: use <span class="kbd">Tab</span> then <span class="kbd">Enter</span> to choose. Press <span class="kbd">R</span> to restart.</span>
    </div></div>
  </footer>
</div>

<script>
(() => {
  const INTERLUDE_IMAGES = [
    "north-1.jpg", // after Memory
    "north-2.jpg", // after Flesh
    "north-3.jpg"  // after Fire
  ];

  let score = 0, stepsDone = 0;
  const stepsTotal = 3;
  const bar = document.getElementById('bar');

  const interlude = document.getElementById('interlude');
  const interludeImg = document.getElementById('interlude-img');
  const continueBtn = document.getElementById('continueBtn');
  let queuedNext = null;

  function show(id){
    document.querySelectorAll('.bubble').forEach(el => { if(el.id!==id) el.style.display='none'; });
    interlude.style.display = 'none';
    const node = document.getElementById(id);
    if(node){ node.style.display='block'; node.scrollIntoView({behavior:'smooth',block:'start'}); }
  }

  function progress(){
    stepsDone = Math.min(stepsTotal, stepsDone + 1);
    bar.style.width = Math.round((stepsDone/stepsTotal)*100) + '%';
  }

  function showInterlude(imageIndex, nextId){
    queuedNext = nextId;
    interludeImg.src = INTERLUDE_IMAGES[imageIndex] || "";
    interlude.style.display = 'block';
    interlude.scrollIntoView({behavior:'smooth',block:'center'});
  }

  continueBtn.addEventListener('click', ()=>{
    if(queuedNext){
      if(['mem','flesh','fire'].includes(queuedNext) || queuedNext==='outcome') progress();
      show(queuedNext);
      if(queuedNext==='outcome'){
        const title = document.getElementById('outcome-title');
        const text  = document.getElementById('outcome-text');
        const again = document.getElementById('again');
        if(score >= 2){
          title.textContent = 'Branding at the Northern Ward';
          text.innerHTML = 'You endured the three shades. The North Witch presses a burning sigil to your skin. \
          You are bound as <b>Firewall Acolyte</b>. The Shield stands.';
        } else {
          title.textContent = 'Frostfall';
          text.textContent  = 'The fire would not take. The auroras dim. Return when the core is ready.';
        }
        again.style.display = 'flex';
      }
      queuedNext = null;
    }
  });

  // Wire choices
  document.querySelectorAll('.btn[data-next]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const add = Number(btn.dataset.score || 0);
      score += add;
      const next = btn.dataset.next;
      const il  = btn.dataset.interlude; // which image to show (0..2)
      // hide the current bubble before interlude
      const parent = btn.closest('.bubble');
      if(parent) parent.style.display = 'none';
      // show interlude image before next step
      showInterlude(Number(il || 0), next);
    });
  });

  // Restart hotkey
  document.addEventListener('keydown', e => { if(e.key.toLowerCase()==='r') location.reload(); });

  show('welcome');
})();
</script>
</body>
</html>
